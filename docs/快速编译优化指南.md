# Rust 编译加速优化指南

## 1. 并行编译设置
```bash
# 设置编译并行度（根据CPU核心数调整）
set CARGO_BUILD_JOBS=8
```

## 2. 增量编译优化
在 Cargo.toml 中添加：
```toml
[profile.dev]
incremental = true
debug = 1  # 减少调试信息
```

## 3. 链接器优化
```toml
[target.x86_64-pc-windows-msvc]
linker = "lld-link"  # 使用更快的链接器
```

## 4. 依赖缓存
```bash
# 清理并重建依赖缓存
cargo clean
cargo fetch
```

## 5. 分模块编译
```bash
# 只编译特定服务
cargo build -p market-data
cargo build -p trading-engine
```

## 6. 编译时内存优化
```bash
# 设置更大的栈空间
set RUST_MIN_STACK=8388608
```

## 7. 文件锁问题解决
如果遇到文件锁：
```bash
# 杀死卡住的 cargo 进程
taskkill /f /im cargo.exe
# 删除锁文件
del target\.cargo-lock
```

## 8. 使用 sccache 缓存
```bash
# 安装编译缓存工具
cargo install sccache
set RUSTC_WRAPPER=sccache
```